# Spire Extensions Caching å•å…ƒæµ‹è¯•æŒ‡å—

## ðŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜Žäº† `spire_extensions_caching` é¡¹ç›®çš„å•å…ƒæµ‹è¯•ç»„ç»‡ç»“æž„ã€æµ‹è¯•ç­–ç•¥å’Œæœ€ä½³å®žè·µã€‚é¡¹ç›®é‡‡ç”¨åˆ†å±‚æµ‹è¯•æž¶æž„ï¼Œç¡®ä¿åˆ†å¸ƒå¼ç¼“å­˜åŠŸèƒ½çš„å¯é æ€§å’Œç¨³å®šæ€§ã€‚

## ðŸ—ï¸ æµ‹è¯•æž¶æž„

### åŒ…ç»“æž„
```
src/unittests/
â”œâ”€â”€ basic_functionality/          # åŸºç¡€åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ expiration_policies/          # è¿‡æœŸç­–ç•¥æµ‹è¯•
â”œâ”€â”€ auto_cleanup/                # è‡ªåŠ¨æ¸…ç†æµ‹è¯•
â”œâ”€â”€ boundary_cases/              # è¾¹ç•Œæƒ…å†µæµ‹è¯•
â”œâ”€â”€ configuration/               # é…ç½®é€‰é¡¹æµ‹è¯•
â”œâ”€â”€ performance/                 # æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ error_handling/             # é”™è¯¯å¤„ç†æµ‹è¯•
â”œâ”€â”€ integration/                 # é›†æˆæµ‹è¯•
â”œâ”€â”€ concurrency/                # å¹¶å‘æµ‹è¯•
â””â”€â”€ stress_testing/             # åŽ‹åŠ›æµ‹è¯•
```

### å‘½åè§„èŒƒ
- **æ–‡ä»¶å¤¹**: ä½¿ç”¨å°å†™å­—æ¯åŠ ä¸‹åˆ’çº¿ (snake_case)
- **æµ‹è¯•æ–‡ä»¶**: ä½¿ç”¨é©¼å³°å‘½åæ³• (PascalCase)
- **æµ‹è¯•æ–¹æ³•**: ä½¿ç”¨ä¸­æ–‡æè¿°æ€§åç§°
- **åŒ…å**: `spire_extensions_caching.unittests.{category}`

## ðŸ“ æµ‹è¯•åˆ†ç±»è¯¦è§£

### 1. åŸºç¡€åŠŸèƒ½æµ‹è¯• (`basic_functionality/`)

**æ–‡ä»¶**: `BasicCacheOperations.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.basic_functionality`

#### æµ‹è¯•èŒƒå›´
- âœ… ç¼“å­˜åŸºç¡€è®¾ç½®å’ŒèŽ·å–åŠŸèƒ½
- âœ… èŽ·å–ä¸å­˜åœ¨çš„é”®å¤„ç†
- âœ… ç¼“å­˜é¡¹åˆ é™¤åŠŸèƒ½
- âœ… ç¼“å­˜é¡¹åˆ·æ–°åŠŸèƒ½

#### æµ‹è¯•æ–¹æ³•
```cj
/**
 * æµ‹è¯•ç¼“å­˜çš„åŸºç¡€è®¾ç½®å’ŒèŽ·å–åŠŸèƒ½
 * éªŒè¯ï¼šå­—ç¬¦ä¸²å’Œå­—èŠ‚æ•°ç»„çš„å­˜å‚¨å’Œæ£€ç´¢åŠŸèƒ½æ­£å¸¸å·¥ä½œ
 * æµ‹è¯•å†…å®¹ï¼šsetString/getString å’Œ set/get æ–¹æ³•çš„åŸºæœ¬åŠŸèƒ½
 */
@Test
func æµ‹è¯•åŸºç¡€è®¾ç½®å’ŒèŽ·å–()
```

### 2. è¿‡æœŸç­–ç•¥æµ‹è¯• (`expiration_policies/`)

**æ–‡ä»¶**: `ExpirationPolicies.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.expiration_policies`

#### æµ‹è¯•èŒƒå›´
- âœ… æ»‘åŠ¨è¿‡æœŸæ—¶é—´ç­–ç•¥
- âœ… ç»å¯¹è¿‡æœŸæ—¶é—´ç­–ç•¥
- âœ… ç›¸å¯¹è¿‡æœŸæ—¶é—´ç­–ç•¥
- âœ… å¤šé‡è¿‡æœŸæ¡ä»¶ç»„åˆ

#### æµ‹è¯•åœºæ™¯
- **æ»‘åŠ¨è¿‡æœŸ**: éªŒè¯è®¿é—®æ—¶é‡ç½®è®¡æ—¶å™¨
- **ç»å¯¹è¿‡æœŸ**: éªŒè¯å›ºå®šæ—¶é—´ç‚¹è¿‡æœŸ
- **ç›¸å¯¹è¿‡æœŸ**: éªŒè¯ä»Žè®¾ç½®æ—¶é—´å¼€å§‹è®¡ç®—
- **å¤šé‡æ¡ä»¶**: éªŒè¯ä»»ä¸€æ¡ä»¶æ»¡è¶³å³è¿‡æœŸ

### 3. è‡ªåŠ¨æ¸…ç†æµ‹è¯• (`auto_cleanup/`)

**æ–‡ä»¶**: `AutoCleanup.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.auto_cleanup`

#### æµ‹è¯•èŒƒå›´
- âœ… è¿‡æœŸé¡¹è‡ªåŠ¨æ¸…ç†æœºåˆ¶
- âœ… åŽå°æ¸…ç†çº¿ç¨‹æ€§èƒ½

#### æµ‹è¯•ç‰¹ç‚¹
- éªŒè¯åŽå°æ¸…ç†çº¿ç¨‹çš„æ­£ç¡®æ€§
- æµ‹è¯•æŒ‰æ—¶é—´é¡ºåºçš„æ¸…ç†é€»è¾‘
- ç¡®ä¿å†…å­˜æ³„æ¼é˜²æŠ¤

### 4. è¾¹ç•Œæƒ…å†µæµ‹è¯• (`boundary_cases/`)

**æ–‡ä»¶**: `BoundaryCases.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.boundary_cases`

#### æµ‹è¯•èŒƒå›´
- âœ… ç©ºå€¼å¤„ç†èƒ½åŠ›
- âœ… ç‰¹æ®Šå­—ç¬¦å¤„ç†
- âœ… é¢‘ç¹è®¿é—®æ€§èƒ½

#### è¾¹ç•Œåœºæ™¯
- ç©ºå­—ç¬¦ä¸²å’Œç©ºå­—èŠ‚æ•°ç»„
- ä¸­æ–‡ã€emojiã€ç‰¹æ®Šç¬¦å·
- è¿žç»­100æ¬¡è®¿é—®åŒä¸€é”®

### 5. é…ç½®é€‰é¡¹æµ‹è¯• (`configuration/`)

**æ–‡ä»¶**: `Configuration.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.configuration`

#### æµ‹è¯•èŒƒå›´
- âœ… DistributedCacheOptions é…ç½®
- âœ… DistributedCacheEntryOptions é…ç½®

#### é…ç½®éªŒè¯
- è‡ªå®šä¹‰è¿‡æœŸæ‰«æé¢‘çŽ‡
- é»˜è®¤é…ç½®å€¼éªŒè¯
- å„ç§è¿‡æœŸç­–ç•¥é…ç½®

### 6. æ€§èƒ½æµ‹è¯• (`performance/`)

**æ–‡ä»¶**: `Performance.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.performance`

#### æµ‹è¯•èŒƒå›´
- âœ… å†…å­˜ä½¿ç”¨ç›‘æŽ§
- âœ… ç¼“å­˜é¡¹æ•°é‡ç»Ÿè®¡

#### æ€§èƒ½æŒ‡æ ‡
- ç¼“å­˜é¡¹æ·»åŠ /åˆ é™¤ç»Ÿè®¡
- å†…å­˜ä½¿ç”¨æ•ˆçŽ‡
- æ“ä½œå“åº”æ—¶é—´

### 7. é”™è¯¯å¤„ç†æµ‹è¯• (`error_handling/`)

**æ–‡ä»¶**: `ErrorHandling.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.error_handling`

#### æµ‹è¯•èŒƒå›´
- âœ… æ— æ•ˆé”®å¤„ç†
- âœ… é‡å¤é”®è¦†ç›–

#### é”™è¯¯åœºæ™¯
- ç©ºé”®çš„å¤„ç†
- é”®å€¼è¦†ç›–çš„æ­£ç¡®æ€§
- å¼‚å¸¸æƒ…å†µçš„å®¹é”™æ€§

### 8. é›†æˆæµ‹è¯• (`integration/`)

**æ–‡ä»¶**: `Integration.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.integration`

#### æµ‹è¯•èŒƒå›´
- âœ… å®Œæ•´ç¼“å­˜ç”Ÿå‘½å‘¨æœŸ

#### é›†æˆåœºæ™¯
- è®¾ç½® â†’ éªŒè¯ â†’ åˆ·æ–° â†’ è¿‡æœŸ â†’ æ¸…ç†
- ç«¯åˆ°ç«¯çš„åŠŸèƒ½éªŒè¯
- ç»„ä»¶é—´åä½œæµ‹è¯•

### 9. å¹¶å‘æµ‹è¯• (`concurrency/`)

**æ–‡ä»¶**: `Concurrency.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.concurrency`

#### æµ‹è¯•èŒƒå›´
- âœ… å¹¶å‘è®¾ç½®å’ŒèŽ·å–
- âœ… çº¿ç¨‹å®‰å…¨éªŒè¯

#### å¹¶å‘åœºæ™¯
- å¤šçº¿ç¨‹å¹¶å‘è®¾ç½®
- å¤šçº¿ç¨‹å¹¶å‘èŽ·å–
- æ•°æ®ä¸€è‡´æ€§éªŒè¯

### 10. åŽ‹åŠ›æµ‹è¯• (`stress_testing/`)

**æ–‡ä»¶**: `StressTesting.cj`  
**åŒ…å**: `spire_extensions_caching.unittests.stress_testing`

#### æµ‹è¯•èŒƒå›´
- âœ… å¤§é‡æ•°æ®å­˜å‚¨æ€§èƒ½
- âœ… è¿‡æœŸæ¸…ç†æ€§èƒ½

#### åŽ‹åŠ›åœºæ™¯
- 1000ä¸ªé”®å€¼å¯¹å­˜å‚¨
- 100ä¸ªçŸ­æœŸè¿‡æœŸé¡¹æ‰¹é‡æ¸…ç†
- æžé™æ¡ä»¶ä¸‹çš„æ€§èƒ½è¡¨çŽ°

## ðŸ§ª æµ‹è¯•æ‰§è¡Œ

### è¿è¡Œå•ä¸ªæµ‹è¯•
```bash
# è¿è¡ŒåŸºç¡€åŠŸèƒ½æµ‹è¯•
cj test src/unittests/basic_functionality/BasicCacheOperations.cj

# è¿è¡Œè¿‡æœŸç­–ç•¥æµ‹è¯•
cj test src/unittests/expiration_policies/ExpirationPolicies.cj
```

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•
cj test src/unittests/
```

### æµ‹è¯•è¦†ç›–çŽ‡
```bash
# ç”Ÿæˆæµ‹è¯•è¦†ç›–çŽ‡æŠ¥å‘Š
cj test --coverage src/unittests/
```

## ðŸ“Š æµ‹è¯•ç»Ÿè®¡

### æµ‹è¯•ç”¨ä¾‹åˆ†å¸ƒ
| æµ‹è¯•ç±»åˆ« | æµ‹è¯•ç”¨ä¾‹æ•° | è¦†ç›–çŽ‡ |
|---------|-----------|--------|
| åŸºç¡€åŠŸèƒ½ | 4 | 100% |
| è¿‡æœŸç­–ç•¥ | 4 | 100% |
| è‡ªåŠ¨æ¸…ç† | 1 | 100% |
| è¾¹ç•Œæƒ…å†µ | 3 | 100% |
| é…ç½®é€‰é¡¹ | 2 | 100% |
| æ€§èƒ½æµ‹è¯• | 1 | 100% |
| é”™è¯¯å¤„ç† | 2 | 100% |
| é›†æˆæµ‹è¯• | 1 | 100% |
| å¹¶å‘æµ‹è¯• | 1 | 100% |
| åŽ‹åŠ›æµ‹è¯• | 2 | 100% |
| **æ€»è®¡** | **21** | **100%** |

### åŠŸèƒ½è¦†ç›–
- âœ… IDistributedCache æŽ¥å£æ‰€æœ‰æ–¹æ³•
- âœ… MemoryDistributedCache å®žçŽ°æ‰€æœ‰åŠŸèƒ½
- âœ… æ‰€æœ‰è¿‡æœŸç­–ç•¥ç»„åˆ
- âœ… è‡ªåŠ¨æ¸…ç†æœºåˆ¶
- âœ… å¹¶å‘å®‰å…¨ä¿è¯
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶

## ðŸ”§ æµ‹è¯•æœ€ä½³å®žè·µ

### 1. æµ‹è¯•å‘½åè§„èŒƒ
```cj
/**
 * æµ‹è¯•[åŠŸèƒ½åç§°]
 * éªŒè¯ï¼š[å…·ä½“éªŒè¯ç‚¹]
 * æµ‹è¯•å†…å®¹ï¼š[è¯¦ç»†æµ‹è¯•å†…å®¹]
 */
@Test
func æµ‹è¯•[åŠŸèƒ½åç§°]() {
    // æµ‹è¯•å®žçŽ°
}
```

### 2. æµ‹è¯•æ•°æ®ç®¡ç†
- ä½¿ç”¨ç‹¬ç«‹çš„æµ‹è¯•æ•°æ®
- é¿å…æµ‹è¯•é—´çš„æ•°æ®ä¾èµ–
- æ¸…ç†æµ‹è¯•äº§ç”Ÿçš„å‰¯ä½œç”¨

### 3. å¼‚æ­¥æµ‹è¯•å¤„ç†
```cj
// ç­‰å¾…å¼‚æ­¥æ“ä½œå®Œæˆ
sleep(Duration.second * 2)

// éªŒè¯å¼‚æ­¥ç»“æžœ
@Expect(result.isSome(), true)
```

### 4. è¾¹ç•Œæ¡ä»¶æµ‹è¯•
- ç©ºå€¼å¤„ç†
- æžé™å€¼æµ‹è¯•
- å¼‚å¸¸æƒ…å†µå¤„ç†

## ðŸš€ æŒç»­é›†æˆ

### CI/CD é…ç½®
```yaml
# .github/workflows/test.yml
name: Unit Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run Tests
        run: cj test src/unittests/
      - name: Generate Coverage
        run: cj test --coverage src/unittests/
```

### æµ‹è¯•è´¨é‡é—¨ç¦
- æµ‹è¯•é€šè¿‡çŽ‡: 100%
- ä»£ç è¦†ç›–çŽ‡: > 90%
- æµ‹è¯•æ‰§è¡Œæ—¶é—´: < 60ç§’

## ðŸ“ˆ æµ‹è¯•ç»´æŠ¤

### æ·»åŠ æ–°æµ‹è¯•
1. ç¡®å®šæµ‹è¯•ç±»åˆ«
2. åˆ›å»ºæµ‹è¯•æ–‡ä»¶ï¼ˆå¦‚æžœä¸å­˜åœ¨ï¼‰
3. æ·»åŠ æµ‹è¯•æ–¹æ³•
4. æ›´æ–°æ–‡æ¡£

### ä¿®æ”¹çŽ°æœ‰æµ‹è¯•
1. ä¿æŒå‘åŽå…¼å®¹
2. æ›´æ–°ç›¸å…³æ–‡æ¡£
3. éªŒè¯æµ‹è¯•è¦†ç›–çŽ‡

### æµ‹è¯•é‡æž„
1. æå–å…¬å…±æµ‹è¯•é€»è¾‘
2. ä¼˜åŒ–æµ‹è¯•æ€§èƒ½
3. ç®€åŒ–æµ‹è¯•ä»£ç 

## ðŸ› å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å¤„ç†æµ‹è¯•ä¸­çš„æ—¶é—´ä¾èµ–ï¼Ÿ
A: ä½¿ç”¨ `sleep()` å‡½æ•°ç­‰å¾…å¼‚æ­¥æ“ä½œï¼Œå¹¶è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´ã€‚

### Q: å¦‚ä½•æµ‹è¯•å¹¶å‘åœºæ™¯ï¼Ÿ
A: ä½¿ç”¨ `spawn` åˆ›å»ºå¹¶å‘ä»»åŠ¡ï¼Œå¹¶éªŒè¯æœ€ç»ˆçŠ¶æ€çš„ä¸€è‡´æ€§ã€‚

### Q: å¦‚ä½•éªŒè¯ç¼“å­˜è¿‡æœŸï¼Ÿ
A: è®¾ç½®çŸ­æœŸè¿‡æœŸæ—¶é—´ï¼Œç­‰å¾…è¿‡æœŸåŽéªŒè¯é¡¹å·²è¢«æ¸…ç†ã€‚

### Q: å¦‚ä½•å¤„ç†æµ‹è¯•æ•°æ®éš”ç¦»ï¼Ÿ
A: æ¯ä¸ªæµ‹è¯•ä½¿ç”¨ç‹¬ç«‹çš„ç¼“å­˜å®žä¾‹ï¼Œé¿å…æµ‹è¯•é—´çš„æ•°æ®æ±¡æŸ“ã€‚

## ðŸ“š ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®README](../README.md)
- [APIæ–‡æ¡£](../docs/API.md)
- [æ€§èƒ½åŸºå‡†](../docs/Benchmarks.md)
- [éƒ¨ç½²æŒ‡å—](../docs/Deployment.md)

---

**æœ€åŽæ›´æ–°**: 2024å¹´7æœˆ16æ—¥  
**ç‰ˆæœ¬**: 1.0.0  
**ç»´æŠ¤è€…**: Soulsoftå›¢é˜Ÿ 