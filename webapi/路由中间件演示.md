# Spire WebAPI 路由中间件演示

本示例演示如何在 `webapi` 项目中集成和使用 Spire 路由中间件，实现基本的 HTTP 路由分发。

---

## 1. 项目结构

```
webapi/
  ├─ src/
  │    └─ main.cj
  └─ cjpm.toml
```

---

## 2. 示例代码

在 `webapi/src/main.cj` 文件中：

```cj
package webapi

// 引入必要的 Spire 包
import spire_web_http.*
import spire_web_hosting.*
import spire_web_routing.*
import spire_extensions_injection.*

main() {
    // 1. 创建主机构造器
    let builder = WebHost.createBuilder()
    // 2. 注册路由服务
    builder.services.addRouting()

    // 3. 构建主机
    let host = builder.build()

    // 4. 注册路由终结点
    host.useEndpoints { endpoints: EndpointRouteBuilder =>
        // GET 路由示例
        endpoints.mapGet("hello") { context =>
            context.response.write("Hello from webapi!")
        }
        // POST 路由示例
        endpoints.mapPost("echo") { context =>
            let body = context.request.readBody()
            context.response.write("Echo: " + body)
        }
    }

    // 5. 启动主机
    host.run()
    return 0
}
```

---

## 3. 说明

- `addRouting()` 注册路由服务。
- `useEndpoints` 注册路由规则，支持 GET/POST 等多种 HTTP 方法。
- 通过 `mapGet` 和 `mapPost` 分别处理不同类型的请求。
- 可根据实际需求扩展更多路由和处理逻辑。

---

## 4. 运行方式

在项目根目录下执行 Spire 启动命令（如 `cjpm run` 或自定义启动脚本），即可访问 `/hello` 和 `/echo` 路由进行测试。

---

如需更复杂的路由功能，可参考 Spire 官方文档或扩展控制器路由。
